export default async function handler(req, res) {
  // CORS / preflight
  if (req.method === 'OPTIONS') {
    res.setHeader('Access-Control-Allow-Origin','*');
    res.setHeader('Access-Control-Allow-Methods','POST, OPTIONS');
    res.setHeader('Access-Control-Allow-Headers','Content-Type, Authorization');
    return res.status(204).end();
  }

  if (req.method !== 'POST') {
    res.setHeader('Access-Control-Allow-Origin','*');
    return res.status(405).json({ error: 'POST required' });
  }

  res.setHeader('Access-Control-Allow-Origin','*');

  const { icp, features, pageText } = req.body || {};

  return res.status(200).json({
    score_ai: 42,
    reasons_ai: ['endpoint OK', 'r√©ponse de test', 'branche l\'IA ensuite'],
    labels: ['ok']
  });
}
